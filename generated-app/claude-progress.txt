CANOPY PROJECT MANAGEMENT APP - Progress Tracker
==================================================

CURRENT STATUS: Phase 4 Complete - Full-Featured App with 43/43 E2E Tests Passing
LAST UPDATED: 2026-02-27 (Session 5)

COMPLETED:
-----------
Phase 0: Monorepo Restructuring
- Root package.json with workspaces: [shared, backend, frontend, infrastructure]
- tsconfig.base.json with shared TypeScript config
- All workspace directories created

Phase 1: Shared Contract (@canopy/shared)
- All Zod schemas written (common, project, issue, sprint, board, comment, search)
- Types file with z.infer<> type exports
- Endpoints route map
- Compiles successfully: cd shared && npx tsc --noEmit

Phase 2a: CDK Infrastructure
- Stack: DynamoDB (single-table + 3 GSIs), Lambda (NodejsFunction), API Gateway HTTP API, S3+CloudFront
- All resources prefixed with canopy-
- CDK tests: 10/10 passing (structural assertions, CI-compatible)
- CDK synth: produces valid CloudFormation template
- Outputs: ApiUrl, FrontendBucketName, DistributionId, DistributionDomain

Phase 2b: Backend Lambda Handlers (Full)
- Router in backend/src/index.ts with pattern matching
- Full CRUD handlers: projects, issues, sprints, boards, comments, search
- DynamoDB helpers in backend/src/lib/db.ts
- Compiles successfully: cd backend && npx tsc --noEmit

Phase 3: Frontend (React 19 + Vite + Tailwind CSS v4)
- All pages: Dashboard, BoardView, BacklogView, SprintsView, RoadmapView,
  ReportsView (Burndown, Velocity, SprintReport), SettingsView, LabelsView, ComponentsView
- Components: TopNav, Sidebar, AppLayout, CreateIssueModal, IssueDetailPanel,
  SearchModal, Toast, KeyboardShortcuts, ErrorBoundary
- API client with VITE_API_URL + full localStorage fallback
- React Query hooks for all CRUD operations
- AppContext: theme, sidebar, project, issue selection, modals
- DnD: @dnd-kit integration with PointerSensor (8px activation for clicks)
- Design: Forest palette (#1B4332, #D4A373, #FAF9F6)
  Space Grotesk + DM Sans + JetBrains Mono
- Dark theme: @custom-variant dark with class toggling
- Stagger animations, shimmer skeletons, smooth transitions
- Keyboard shortcuts: Cmd+K search, Cmd+[ sidebar, C create, ? shortcuts, Esc close
- Build: ~407KB JS + ~38KB CSS (Recharts lazy-loaded: ~448KB separate chunk)

Phase 4: Polish (Complete)
- ErrorBoundary component wrapping all routes
- Comment system in IssueDetailPanel (add/list)
- Connectivity indicator in TopNav (API/Local mode)
- Board: Column point totals, label badges, due date icons, assignee avatars on cards
- Board: Quick filter for searching cards
- Backlog: Move-to-sprint dropdown, type/status filters, sort by manual/priority/newest
- SprintsView: Inline editing (name/goal/dates), expandable issue list, date pickers
- SearchModal: Keyboard navigation (up/down Enter Esc), status badges
- RoadmapView: Gantt-style timeline, week/month headers, TODAY marker
- ReportsView: Recharts AreaChart/BarChart/PieChart (lazy-loaded for code splitting)
- IssueDetailPanel: Sprint assignment, time tracking, inline editing, delete confirm,
  assignee field, labels field, due date field, time estimate field
- CreateIssueModal: No-project warning, description, labels, due date fields, Cmd+Enter submit
- Dashboard: Quick stats row (projects, issues, status, date), description field
- SettingsView: Data export/import/clear functionality, board column config
- LabelsView: Inline editing, descriptions, issue usage counts, delete warnings
- ComponentsView: Inline editing, issue usage counts, improved empty state
- Sidebar: Fixed routes, improved active state, data-testid attributes
- TopNav: data-testid for search, create, theme toggle, project dropdown
- KeyboardShortcuts dialog (? key)
- Dark mode: Fixed with @custom-variant dark for Tailwind CSS v4
- Accessibility: prefers-reduced-motion, focus-visible rings
- DnD: PointerSensor with 8px activation for better click handling

CI/CD INFRASTRUCTURE STATUS:
-----------------------------
- CDK tests: 10/10 passing (structural assertions, CI-compatible)
- CDK synth: Working, produces valid CloudFormation template
- GitHub Actions workflow: deploy-infrastructure.yml
  - Trigger: push to agent-runtime when infrastructure/** changes
  - Tests pass in CI, synth succeeds, diff succeeds
  - SSM signal steps have continue-on-error: true (fixed)
  - CDK Deploy fails due to IAM permissions:
    * GitHub Actions IAM user can't assume CDK bootstrap roles
    * No SSM read access for CDK bootstrap version check
    * No S3 write access for CDK asset upload
  - This is a fundamental IAM configuration issue outside code scope
- Frontend works fully with localStorage fallback

VERIFICATION RESULTS (ALL PASS):
---------------------------------
Backend (5/5):
- shared-schemas-compile: PASS
- cdk-synth: PASS
- cdk-tests (10/10): PASS
- backend-compile: PASS
- frontend-build: PASS

E2E Tests (43/43):
- screenshot-all-pages (10 tests): PASS
- functional-tests (7 tests): PASS
- seed-and-verify (2 tests): PASS
- screenshot-helper (6 tests): PASS
- seed-data (1 test): PASS
- seed-screenshots (5 tests): PASS
- 12 additional spec tests: PASS

Console Errors: NONE (0 console errors detected)

ARCHITECTURE:
--------------
generated-app/
  package.json          (workspace root)
  tsconfig.base.json
  shared/               (Zod schemas, types, endpoints - compiles OK)
    schemas/          (project, issue, sprint, board, comment, search, common)
    types.ts          (z.infer type exports)
    endpoints.ts      (API route map)
  backend/              (Lambda handler with routing - compiles OK)
    src/
      index.ts      (router)
      handlers/     (projects, issues, sprints, boards, comments, search)
      lib/db.ts     (DynamoDB helpers)
  infrastructure/       (CDK stack - synths OK, 10/10 tests pass)
    lib/canopy-stack.ts
    bin/canopy.ts
    test/canopy-stack.test.ts
  frontend/             (React SPA - builds OK, dev server on port 6174)
    src/
      api/client.ts         (API + localStorage fallback)
      hooks/useApi.ts       (React Query hooks)
      context/AppContext.tsx (global state)
      pages/                (11 page components)
      components/           (layout, issues, search, ui)
      lib/utils.ts          (helpers)
  e2e-tests/            (Playwright tests - 43/43 pass)

DynamoDB Single-Table Design:
- PK/SK composite keys
- GSI1: project queries (PROJ#id -> ISSUE#status#order, SPRINT#status#time)
- GSI2: assignee queries (USER#id -> updatedAt)
- GSI3: sprint queries (SPRINT#id -> sortOrder)

API Routes (Lambda router):
- POST/GET /projects, GET/PUT/DELETE /projects/:id
- POST/GET /projects/:id/issues
- GET/PUT/DELETE /issues/:id, PUT /issues/bulk
- POST /issues/:id/comments
- POST/GET /projects/:id/sprints, PUT /sprints/:id
- GET /projects/:id/board, PUT /boards/:id
- GET /search
